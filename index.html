<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Valentine ğŸ’–</title>

<style>
* { box-sizing: border-box; }

body {
  margin: 0;
  height: 100vh;
  background: linear-gradient(120deg, #ff4e8a, #ff9a9e);
  font-family: Arial, sans-serif;
  overflow: hidden;
}

.container {
  height: 100%;
  text-align: center;
  padding-top: 30px;
}

h1 {
  color: white;
  font-size: 2rem;
  text-shadow: 2px 2px 10px #ff1493;
  padding: 0 15px;
}

.play-area {
  position: relative;
  width: 100%;
  height: 65vh;
}

button {
  padding: 16px 26px;
  font-size: 18px;
  border: none;
  border-radius: 16px;
  cursor: pointer;
  margin: 6px;
}

#yes { background: #4CAF50; color: white; position: absolute; }
#no  { background: #f44336; color: white; position: absolute; }

.hidden { display: none; }

#cameraPreview video,
#cameraPreview img {
  width: 260px;
  border-radius: 18px;
  margin-top: 12px;
}

.action-btn {
  background: rgba(255,255,255,0.85);
}
</style>
</head>

<body>

<div class="container">
  <h1 id="question">Will you be my Valentine? ğŸ’–ğŸ¥º</h1>

  <div class="play-area" id="playArea">
    <button id="yes" style="left:20%;top:45%;">Yes ğŸ’–</button>
    <button id="no"  style="left:60%;top:45%;">No ğŸ’”</button>
  </div>

  <div id="yesResult" class="hidden">
    <h1>YAYYY ğŸ˜ Selfie time!</h1>

    <div id="cameraPreview">
      <video id="video" autoplay playsinline></video>
      <img id="photo" class="hidden" />
    </div>

    <div>
      <button id="shareBtn" class="action-btn">Share ğŸ’Œ</button>
      <button id="downloadBtn" class="action-btn">Download ğŸ“¥</button>
    </div>
  </div>
</div>

<audio id="yesSong" src="Dil Cheer Ke Dekh(KoshalWorld.Com).mp3"></audio>

<script>
/* =====================
   GAME LOGIC
===================== */
const yesBtn = document.getElementById("yes");
const noBtn = document.getElementById("no");
const playArea = document.getElementById("playArea");
const question = document.getElementById("question");
const yesResult = document.getElementById("yesResult");

const video = document.getElementById("video");
const photo = document.getElementById("photo");
const shareBtn = document.getElementById("shareBtn");
const downloadBtn = document.getElementById("downloadBtn");

const yesSong = document.getElementById("yesSong");

let dodges = 0;
const REQUIRED = 10;

/* Funny taunts */
const taunts = [
  "Pakadne ka sapna mat dekho ğŸ˜",
  "Aur zor lagao ğŸ˜‚",
  "YES bhag raha hai ğŸ’¨",
  "Relationship test chal raha hai ğŸ˜ˆ",
  "Bas thoda aur ğŸ˜œ",
  "Mouse thak gaya kya ğŸ˜",
  "Mobile pe ho? LOL ğŸ¤¡",
  "Almostâ€¦ NOT ğŸ˜†",
  "Last try shayad ğŸ˜",
  "Okay fine ğŸ˜Œ"
];

function moveYes() {
  const w = playArea.clientWidth - yesBtn.offsetWidth;
  const h = playArea.clientHeight - yesBtn.offsetHeight;
  yesBtn.style.left = Math.random()*w + "px";
  yesBtn.style.top  = Math.random()*h + "px";
  question.textContent = taunts[dodges % taunts.length];
}

yesBtn.onclick = async () => {
  if (dodges < REQUIRED) {
    dodges++;
    moveYes();
    yesSong.play().catch(()=>{});
    return;
  }

  /* SUCCESS */
  playArea.classList.add("hidden");
  question.classList.add("hidden");
  yesResult.classList.remove("hidden");
  startCamera();
};

noBtn.onclick = () => {
  alert("NO not allowed ğŸ˜¤");
};

/* =====================
   ğŸ“¸ CAMERA LOGIC
===================== */
let stream;

async function startCamera() {
  try {
    stream = await navigator.mediaDevices.getUserMedia({
      video: { facingMode: "user" }
    });
    video.srcObject = stream;

    // Auto capture after 2 sec
    setTimeout(capturePhoto, 2000);

  } catch (err) {
    alert("Camera permission denied ğŸ˜¢");
  }
}

function capturePhoto() {
  const canvas = document.createElement("canvas");
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  canvas.getContext("2d").drawImage(video, 0, 0);

  photo.src = canvas.toDataURL("image/png");
  photo.classList.remove("hidden");
  video.classList.add("hidden");

  // stop camera
  stream.getTracks().forEach(t => t.stop());
}

/* =====================
   ğŸ’Œ SHARE
===================== */
shareBtn.onclick = async () => {
  const blob = await (await fetch(photo.src)).blob();
  const file = new File([blob], "valentine.png", { type: "image/png" });

  if (navigator.canShare && navigator.canShare({ files: [file] })) {
    navigator.share({
      files: [file],
      title: "Valentine ğŸ’–",
      text: "I said YES ğŸ˜"
    });
  } else {
    alert("Sharing not supported on this device ğŸ˜¢");
  }
};

/* =====================
   ğŸ“¥ DOWNLOAD
===================== */
downloadBtn.onclick = () => {
  const a = document.createElement("a");
  a.href = photo.src;
  a.download = "valentine-selfie.png";
  a.click();
};
</script>

</body>
</html>
